'use strict';(function(h,g,a){window.shitbot&&window.shitbot.seppuku();var f=window.shitbot={version:"0.4",currentTrack:null,me:null,chats:2,commands:{die:function(b,d,c){a.getUser(c).permission>=a.ROLE.BOUNCER?this.seppuku():this.doChat("YOU CAN'T TELL ME WHAT TO DO @",b.toUpperCase(),"!")},about:function(b){this.doChat("@",b,": This is shitbot v",this.version," filling in the gaps until a better bot comes online.")},status:function(){this.doChat("Not great")},taco:function(b){this.doChat("@",b,
": Do I look like a chef?")},drink:function(b){this.doChat("@",b,": Do I look like a barkeep?")},info:function(){this.doChat("No Dubstep or Skrillex! 8 minutes max each tune. We play DnB like Liquidfunk, Neurofunk, Jungle, Jump up or *Breaks* except Drumstep and Breakcore. Read about the genre we play here: http://en.wikipedia.org/wiki/Drum_and_bass")},rules:function(){this.doChat("The only genres allowed here are DnB and Breakbeat except Drumstep and Breakcore. If a tune/mix is off-genre or involves Skrillex, it will be skipped. If a tune/mix is longer than 8 minutes, it will be skipped at the 8-minute mark. Also, have fun!")},
whymeh:function(){this.doChat("Please reserve Mehs for songs that are a) extremely overplayed b) off genre c) absolutely god awful or d) troll songs. If you simply aren't feeling a song, then please remain neutral.")}},doChat:function(){var b=g(arguments).toArray().join("");a.sendChat(b)},onRoomScoreUpdate:function(b){console.log("on room score update",b);b.positive&&(this.currentTrack=b)},onAdvance:function(b){console.log("on advance",b);var d=[];if(this.currentTrack){var c=this.currentTrack;this.currentTrack=
null;var e=a.getUsers().length-2;d.push("Last track got a ",Math.floor(100*(c.positive/e)),"% approval rating");c.negative&&d.push(" with ",c.negative," mehs");c.curates&&d.push(" and ",c.curate," snatches");d.push("! ")}this.doChat(d.join(""),"Up Next: ",b.dj.username,' with "',b.media.title,'" by ',b.media.author)},onCurate:function(b){var d="this track";4<this.chats&&(d=a.getMedia().title);console.log("on Curate",b,d);this.doChat(b.user.username," snatched ",d,"!")},onChat:function(b){console.log("on chat",
b);b.fromID===this.me.id?this.chats=0:this.chats++;if(this.chats&&"message"===b.type){var a=b.message;"."===a&&2<this.chats&&this.doChat(".");if(";"===a.substring(0,1)){var c=a.indexOf(" ");-1===c&&(c=void 0);var e=a.substring(1,c);(e=this.commands[e])&&e.call(this,b.from,c?a.substring(c+1):"",b.fromID)}}},onLoad:function(){console.log("on load");this.me=a.getUser();a.on(a.ROOM_SCORE_UPDATE,this.onRoomScoreUpdate,this);a.on(a.CURATE_UPDATE,this.onCurate,this);a.on(a.DJ_ADVANCE,this.onAdvance,this);
a.on(a.CHAT,this.onChat,this);this.doChat("Shitbot v",this.version," now online! (Now with 50% less spam)")},seppuku:function(){console.log("RIP");a.off(a.ROOM_SCORE_UPDATE,this.onRoomScoreUpdate,this);a.off(a.CURATE_UPDATE,this.onCurate,this);a.off(a.DJ_AVDANCE,this.onAdvance,this);a.off(a.CHAT,this.onChat,this);this.doChat("Shitbot v",this.version," signing off. Bye!")}};g.bindAll(f,"onLoad");h(f.onLoad);return f})(jQuery,_,API);
